"use strict";(self.webpackChunkstudy_note=self.webpackChunkstudy_note||[]).push([[666],{6165:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-91fcaaaa",path:"/nuxtJs/introduction/",title:"服务端渲染和单页应用",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"渲染一个vue实例",slug:"渲染一个vue实例",children:[]},{level:2,title:"与服务器集成",slug:"与服务器集成",children:[]},{level:2,title:"客户端动态标签",slug:"客户端动态标签",children:[]},{level:2,title:"使用webpack的源码构建",slug:"使用webpack的源码构建",children:[]},{level:2,title:"构建配置",slug:"构建配置",children:[{level:3,title:"安装依赖",slug:"安装依赖",children:[]},{level:3,title:"webpack配置",slug:"webpack配置",children:[]},{level:3,title:"开发模式构建",slug:"开发模式构建",children:[]}]},{level:2,title:"路由处理",slug:"路由处理",children:[]}],filePathRelative:"nuxtJs/introduction/readme.md",git:{updatedTime:1635331137e3}}},3066:(n,s,a)=>{a.r(s),a.d(s,{default:()=>kn});var e=a(6252),t=a(8706);const o=(0,e._)("h1",{id:"服务端渲染和单页应用",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#服务端渲染和单页应用","aria-hidden":"true"},"#"),(0,e.Uk)(" 服务端渲染和单页应用")],-1),c=(0,e._)("p",null,"服务端渲染有早先的php，jsp等，都是后端通过模板语言直接渲染页面，好处是一次页面请求就能拿到所有数据， 展现速度块。",-1),l=(0,e._)("p",null,"单页应用，如vue、react等框架，解决了复杂场景下，前端的代码效率问题，降低了频繁操作dom的复杂度。但是因为要请求数据和js，渲染速度慢，且无法seo",-1),p=(0,e._)("p",null,[(0,e._)("strong",null,"同构渲染")],-1),u=(0,e._)("p",null,"基于React、Vue等框架，客户端渲染和服务端渲染的结合",-1),_=(0,e._)("ul",null,[(0,e._)("li",null,"在服务器端执行一次，用于实现服务器渲染（首屏直出）"),(0,e._)("li",null,"在客户端再执行一次，用于接管页面交互"),(0,e._)("li",null,"核心解决seo和首屏渲染慢的问题"),(0,e._)("li",null,"拥有传统服务端渲染的优点，也有客户端渲染的优点")],-1),r=(0,e._)("p",null,"同构渲染的问题",-1),k=(0,e._)("ol",null,[(0,e._)("li",null,"开发条件有限"),(0,e._)("li",null,"更多服务端资源")],-1),i=(0,e._)("h1",{id:"vue-ssr",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vue-ssr","aria-hidden":"true"},"#"),(0,e.Uk)(" vue ssr")],-1),b=(0,e._)("p",null,[(0,e.Uk)("vue SSR是vue官方提供的一个服务端渲染解决方案。在学习中使用官方方案，帮助我们了解底层。对于使用"),(0,e._)("code",null,"nuxtjs"),(0,e.Uk)("这种开发框架有帮助")],-1),U=(0,e._)("h1",{id:"vuessr的基本使用",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#vuessr的基本使用","aria-hidden":"true"},"#"),(0,e.Uk)(" VueSSR的基本使用")],-1),m=(0,e._)("h2",{id:"渲染一个vue实例",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#渲染一个vue实例","aria-hidden":"true"},"#"),(0,e.Uk)(" 渲染一个vue实例")],-1),d=(0,e._)("p",null,"基于官方的第一个示例，我们动手操作一下",-1),g=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token comment"},"// 1. 引入库"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" Vue "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"createRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// 创建实例"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" app "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Vue"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  data"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    message"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},'\n    <div id="app">\n      <h1>{{message}}</h1>\n    </div>\n  '),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// 将vue实例渲染位html"),(0,e.Uk)("\nrenderer"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"renderToString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("app"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" html")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"throw"),(0,e.Uk)(" err\n  console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("html"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// 使用node执行我们可以得到一个字符串，并且含有一个属性"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token operator"},"<"),(0,e.Uk)("div id"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token string"},'"app"'),(0,e.Uk)(" data"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("server"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("rendered"),(0,e._)("span",{class:"token operator"},"="),(0,e._)("span",{class:"token string"},'"true"'),(0,e._)("span",{class:"token operator"},">"),(0,e._)("span",{class:"token operator"},"<"),(0,e.Uk)("h1"),(0,e._)("span",{class:"token operator"},">"),(0,e.Uk)("拉钩教育"),(0,e._)("span",{class:"token operator"},"<"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("h1"),(0,e._)("span",{class:"token operator"},">"),(0,e._)("span",{class:"token operator"},"<"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("div"),(0,e._)("span",{class:"token operator"},">"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br")])],-1),v=(0,e._)("h2",{id:"与服务器集成",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#与服务器集成","aria-hidden":"true"},"#"),(0,e.Uk)(" 与服务器集成")],-1),f=(0,e._)("p",null,[(0,e._)("code",null,"createRenderer"),(0,e.Uk)("支持传入一个"),(0,e._)("code",null,"options"),(0,e.Uk)("参数，里面可以传入一个模板")],-1),w=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"createRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'fs'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./index.template.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),h=(0,e._)("p",null,[(0,e._)("code",null,"renderToString"),(0,e.Uk)("可以传入三个参数，vue实例、content对象、回调函数")],-1),y=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("renderer"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"renderToString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n    app"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      title"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      meta"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'\'<meta name="description" content="拉钩教育" />\''),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" html")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"status"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"500"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'服务器出错'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 设置请求头"),(0,e.Uk)("\n      res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("html"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),x=(0,e._)("p",null,[(0,e.Uk)("所以整体的"),(0,e._)("code",null,"vue"),(0,e.Uk)("、"),(0,e._)("code",null,"vue-server-renderer"),(0,e.Uk)("和"),(0,e._)("code",null,"express"),(0,e.Uk)("组合就能完成最基本的"),(0,e._)("code",null,"node"),(0,e.Uk)("读取模板， "),(0,e._)("code",null,"renderer"),(0,e.Uk)("渲染模板，并通过"),(0,e._)("code",null,"express"),(0,e.Uk)("返回到客户端页面上，整体最简单的一个服务端渲染为")],-1),j=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" Vue "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" express "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'express'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" fs "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'fs'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"createRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" fs"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./index.template.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" server "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"express"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"get"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'/'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("req"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" res")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" app "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Vue"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    data"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      message"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},'\n    <div id="app">\n      <h1>{{message}}</h1>\n    </div>\n  '),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  renderer"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"renderToString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n    app"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      title"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      meta"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'\'<meta name="description" content="拉钩教育" />\''),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" html")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"status"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"500"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'服务器出错'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 设置请求头"),(0,e.Uk)("\n      res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("html"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"listen"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3000"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'server running at 3000'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br")])],-1),q=(0,e._)("h2",{id:"客户端动态标签",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#客户端动态标签","aria-hidden":"true"},"#"),(0,e.Uk)(" 客户端动态标签")],-1),S=(0,e._)("p",null,[(0,e.Uk)("在完成了基础的渲染之后，我们来看看如何实现动态标签的渲染，在代码中添加"),(0,e._)("code",null,"@click"),(0,e.Uk)("和"),(0,e._)("code",null,"v-model")],-1),C=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" app "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Vue"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n data"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n   message"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n template"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token template-string"},[(0,e._)("span",{class:"token template-punctuation string"},"`"),(0,e._)("span",{class:"token string"},'\n <div id="app">\n   <h1>{{message}}</h1>\n   <h2>客户端动态标签</h2>\n   <div>\n     <input type="text" v-model=\'message\' />\n   </div>\n   <button @click="onClick">点击测试</button>\n </div>\n'),(0,e._)("span",{class:"token template-punctuation string"},"`")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n data"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n   message"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n methods"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n   "),(0,e._)("span",{class:"token function"},"onClick"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n     console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'hello ssr'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n   "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br")])],-1),P=(0,e._)("p",null,[(0,e.Uk)("在浏览器中执行发现，渲染是可以的，但是vue的双向绑定和"),(0,e._)("code",null,"v-on"),(0,e.Uk)("并没有实现，查看网络中的返回就能发现， "),(0,e._)("code",null,"express"),(0,e.Uk)("将数据作为字符串返回了，但是代码中没有客户端的js，所以不能实现动态功能。需要一个客户端的入口文件， 将服务端渲染好的页面激活成动态的客户端Vue页面")],-1),R=(0,e._)("p",null,[(0,e._)("img",{src:t,alt:"构建过程"})],-1),M=(0,e._)("h2",{id:"使用webpack的源码构建",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#使用webpack的源码构建","aria-hidden":"true"},"#"),(0,e.Uk)(" 使用webpack的源码构建")],-1),V=(0,e._)("p",null,[(0,e.Uk)("通过"),(0,e._)("code",null,"webpack"),(0,e.Uk)("我们将需要的代码打包进客户端和服务端，项目的基本结构如下")],-1),B=(0,e._)("div",{class:"language-text ext-text line-numbers-mode"},[(0,e._)("pre",{class:"language-text"},[(0,e._)("code",null,"src\n├── components\n│   ├── Foo.vue\n│   ├── Bar.vue\n│   └── Baz.vue\n├── App.vue\n├── app.js # 通用 entry(universal entry)\n├── entry-client.js # 仅运行于浏览器\n└── entry-server.js # 仅运行于服务器\n")]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br")])],-1),F=(0,e._)("h2",{id:"构建配置",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#构建配置","aria-hidden":"true"},"#"),(0,e.Uk)(" 构建配置")],-1),D=(0,e._)("h3",{id:"安装依赖",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#安装依赖","aria-hidden":"true"},"#"),(0,e.Uk)(" 安装依赖")],-1),E=(0,e._)("ul",null,[(0,e._)("li",null,"安装生产依赖")],-1),N=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("npm i vue vue"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("server"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("renderer express cross"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("env\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br")])],-1),T=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"包"),(0,e._)("th",null,"说明")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"vue"),(0,e._)("td",null,"Vue.js核心库")]),(0,e._)("tr",null,[(0,e._)("td",null,"vue-server-renderer"),(0,e._)("td",null,"Vue服务端渲染工具")]),(0,e._)("tr",null,[(0,e._)("td",null,"express"),(0,e._)("td",null,"基于Node的web服务框架")]),(0,e._)("tr",null,[(0,e._)("td",null,"cross-env"),(0,e._)("td",null,"通过npm script 设置跨平台的环境变量")])])],-1),$=(0,e._)("ul",null,[(0,e._)("li",null,"安装开发依赖")],-1),J=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("npm i "),(0,e._)("span",{class:"token operator"},"-"),(0,e._)("span",{class:"token constant"},"D"),(0,e.Uk)(" webpack webpack"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("cli webpack"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("merge webpack"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("node"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("externals @babel"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("core\n@babel"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("plugin"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("transform"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("runtime @babel"),(0,e._)("span",{class:"token operator"},"/"),(0,e.Uk)("preset"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("env babel"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader css"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader \nurl"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader file"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader rimraf vue"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("loader vue"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("template"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("compiler friendly"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("errors"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("webpack"),(0,e._)("span",{class:"token operator"},"-"),(0,e.Uk)("plugin\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br")])],-1),W=(0,e._)("table",null,[(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"包"),(0,e._)("th",null,"说明")])]),(0,e._)("tbody",null,[(0,e._)("tr",null,[(0,e._)("td",null,"webpack-merge"),(0,e._)("td",null,"webpack 配置信息合并工具")]),(0,e._)("tr",null,[(0,e._)("td",null,"webpack-cli"),(0,e._)("td",null,"webpack 的命令行工具")]),(0,e._)("tr",null,[(0,e._)("td",null,"webpack4"),(0,e._)("td",null,"webpack 核心包")]),(0,e._)("tr",null,[(0,e._)("td",null,"vue-template-compiler vue-loader"),(0,e._)("td",null,"处理 .vue 资源")]),(0,e._)("tr",null,[(0,e._)("td",null,"rimraf"),(0,e._)("td",null,"基于 Node 封装的一个跨平台 rm -rf 工具")]),(0,e._)("tr",null,[(0,e._)("td",null,"friendly-errors-webpack-plugin"),(0,e._)("td",null,"友好的 webpack 错误提示")]),(0,e._)("tr",null,[(0,e._)("td",null,"file-loader"),(0,e._)("td",null,"处理字体资源 在webpack4中需要")]),(0,e._)("tr",null,[(0,e._)("td",null,"url-loader"),(0,e._)("td",null,"处理图片资源 在webpack4中需要")]),(0,e._)("tr",null,[(0,e._)("td",null,"css-loader"),(0,e._)("td",null,"处理 CSS 资源")]),(0,e._)("tr",null,[(0,e._)("td",null,"babel-loader @babel/preset-env @babel/plugin-transform-runtime @babel/core"),(0,e._)("td",null,"Babel 相关工具")])])],-1),z=(0,e._)("p",null,[(0,e._)("strong",null,"因为升级到了webpack5，上面的字体和css相关处理在webpack5中已经内置，friendly-errors-webpack-plugin不支持webpack5")],-1),O=(0,e._)("h3",{id:"webpack配置",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#webpack配置","aria-hidden":"true"},"#"),(0,e.Uk)(" webpack配置")],-1),A=(0,e._)("p",null,"初始化打包配置",-1),L=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e.Uk)("build\n├── webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("base"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("config"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("js # 公共配置\n├── webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("client"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("config"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("js # 客户端打包配置文件\n└── webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("server"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("config"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("js # 服务端打包配置文件\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br")])],-1),H=(0,e._)("p",null,[(0,e._)("code",null,"webpack.base.config.js")],-1),I=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" VueLoaderPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-loader/lib/plugin-webpack5'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// webpack5下的友好报错要使用这个"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" FriendlyErrorsWebpackPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'@soda/friendly-errors-webpack-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// const FriendlyErrorsWebpackPlugin = require('friendly-errors-webpack-plugin')"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"resolve"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"file"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" file"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" isProd "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" process"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("env"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token constant"},"NODE_ENV"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"==="),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'production'"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  mode"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" isProd "),(0,e._)("span",{class:"token operator"},"?"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'production'"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'development'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    path"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../dist/'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    publicPath"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'/dist/'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'[name].[chunkhash].js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  resolve"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    alias"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 路径别名，@ 指向 src"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token string"},"'@'"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../src/'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 可以省略的扩展名"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 当省略扩展名的时候，按照从前往后的顺序依次解析"),(0,e.Uk)("\n    extensions"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'.vue'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'.json'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  devtool"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" isProd "),(0,e._)("span",{class:"token operator"},"?"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'source-map'"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'cheap-module-eval-source-map'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    rules"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 处理图片资源"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.(png|svg|jpg|jpeg|gif)$"),(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-flags"},"i")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 在webpack4中这么使用"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// use: ["),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//   {"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//     loader: 'url-loader',"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//     options: {"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//       limit: 8192,"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//     },"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"//   },"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// ],"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// webpack 5中内置了资源处理模块"),(0,e.Uk)("\n        type"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'asset/resource'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 处理字体资源"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.(woff|woff2|eot|ttf|otf)$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 字体文件同理"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// use: ['file-loader'],"),(0,e.Uk)("\n        type"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'asset/resource'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 处理 .vue 资源"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.vue$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'vue-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 处理 CSS 资源"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 它会应用到普通的 `.css` 文件"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 以及 `.vue` 文件中的 `<style>` 块"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        use"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'vue-style-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'css-loader'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// CSS 预处理器，参考：https://vue-loader.vuejs.org/zh/guide/preprocessors.html"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 例如处理 Less 资源"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// {"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// test: /\\.less$/,"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// use: ["),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 'vue-style-loader',"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 'css-loader',"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 'less-loader'"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// ]"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// },"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"VueLoaderPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"FriendlyErrorsWebpackPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"46"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"47"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"48"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"49"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"50"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"51"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"52"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"53"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"54"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"55"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"56"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"57"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"58"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"59"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"60"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"61"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"62"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"63"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"64"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"65"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"66"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"67"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"68"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"69"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"70"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"71"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"72"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"73"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"74"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"75"),(0,e._)("br")])],-1),Z=(0,e._)("p",null,[(0,e._)("code",null,"webpack.client.config.js"),(0,e.Uk)("服务端的webpack配置")],-1),X=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token doc-comment comment"},"/**\n * 客户端打包配置\n */"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" merge "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-merge'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" baseConfig "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.base.config.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token comment"},"// 重要的客户端配置输出插件"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" VueSSRClientPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer/client-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"merge"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("baseConfig"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    app"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/entry-client.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  module"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    rules"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// ES6 转 ES5"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        test"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.m?js$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        exclude"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"(node_modules|bower_components)"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        use"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n          loader"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'babel-loader'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n          options"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n            presets"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'@babel/preset-env'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            cacheDirectory"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"true"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n            plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token string"},"'@babel/plugin-transform-runtime'"),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n          "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 重要信息：这将 webpack 运行时分离到一个引导 chunk 中，"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 以便可以在之后正确注入异步 chunk。"),(0,e.Uk)("\n  optimization"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    splitChunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      name"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'manifest'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      minChunks"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token number"},"Infinity"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 此插件在输出目录中生成 `vue-ssr-client-manifest.json`。"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"VueSSRClientPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br")])],-1),Y=(0,e._)("p",null,[(0,e._)("code",null,"webpack.server.config.js"),(0,e.Uk)("服务端配置")],-1),G=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token doc-comment comment"},"/**\n * 服务端打包配置\n */"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)(" merge "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-merge'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" nodeExternals "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-node-externals'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" baseConfig "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.base.config.js'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" VueSSRServerPlugin "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer/server-plugin'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("exports "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"merge"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("baseConfig"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 将 entry 指向应用程序的 server entry 文件"),(0,e.Uk)("\n  entry"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'./src/entry-server.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 这允许 webpack 以 Node 适用方式处理模块加载"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 并且还会在编译 Vue 组件时，"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 告知 `vue-loader` 输送面向服务器代码(server-oriented code)。"),(0,e.Uk)("\n  target"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'node'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  output"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    filename"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'server-bundle.js'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 此处告知 server bundle 使用 Node 风格导出模块(Node-style exports)"),(0,e.Uk)("\n    libraryTarget"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'commonjs2'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 不打包 node_modules 第三方包，而是保留 require 方式直接加载"),(0,e.Uk)("\n  externals"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"nodeExternals"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 白名单中的资源依然正常打包"),(0,e.Uk)("\n      allowlist"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e._)("span",{class:"token regex"},[(0,e._)("span",{class:"token regex-delimiter"},"/"),(0,e._)("span",{class:"token regex-source language-regex"},"\\.css$"),(0,e._)("span",{class:"token regex-delimiter"},"/")]),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  plugins"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 这是将服务器的整个输出构建为单个 JSON 文件的插件。"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token comment"},"// 默认文件名为 `vue-ssr-server-bundle.json`"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"VueSSRServerPlugin"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br")])],-1),K=(0,e._)("p",null,[(0,e.Uk)("最后改造"),(0,e._)("code",null,"server.js"),(0,e.Uk)("引入服务端和客户端配置")],-1),Q=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" Vue "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" express "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'express'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" fs "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'fs'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverBundle "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-server-bundle.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientManifest "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-client-manifest.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" template "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" fs"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./index.template.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'vue-server-renderer'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"createBundleRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n  serverBundle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    template"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    clientManifest"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" server "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"express"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token comment"},"//请求静态资源"),(0,e.Uk)("\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"use"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'/dist'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" express"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"static"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"get"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'/'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("req"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" res")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  renderer"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"renderToString"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      title"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'拉钩教育'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      meta"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token string"},'\'<meta name="description" content="拉钩教育" />\''),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" html")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("err"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"status"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"500"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'服务器出错'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token comment"},"// 设置请求头"),(0,e.Uk)("\n      res"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"end"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("html"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"listen"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token number"},"3000"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  console"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"log"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'server running at 3000'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br")])],-1),nn=(0,e._)("div",{class:"language-html ext-html line-numbers-mode"},[(0,e._)("pre",{class:"language-html"},[(0,e._)("code",null,[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("head")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("meta")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"charset"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("UTF-8"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("meta")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"http-equiv"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("X-UA-Compatible"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"content"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("IE=edge"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("meta")]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"name"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("viewport"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e.Uk)(),(0,e._)("span",{class:"token attr-name"},"content"),(0,e._)("span",{class:"token attr-value"},[(0,e._)("span",{class:"token punctuation attr-equals"},"="),(0,e._)("span",{class:"token punctuation"},'"'),(0,e.Uk)("width=device-width, initial-scale=1.0"),(0,e._)("span",{class:"token punctuation"},'"')]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n  {{{meta}}}\n  "),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("title")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("{{title}}"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("title")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("head")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"<"),(0,e.Uk)("body")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"\x3c!-- 需要这个注释来告知App.vue的输出位置 --\x3e"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"\x3c!--vue-ssr-outlet--\x3e"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("body")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token tag"},[(0,e._)("span",{class:"token punctuation"},"</"),(0,e.Uk)("html")]),(0,e._)("span",{class:"token punctuation"},">")]),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br")])],-1),sn=(0,e._)("p",null,"这样一个最基本的不包含路由的vue同构渲染就完成了。",-1),an=(0,e._)("p",null,[(0,e._)("code",null,"https://github.com/idenet/vue-ssr"),(0,e.Uk)("所有代码在这里，切换到"),(0,e._)("code",null,"init"),(0,e.Uk)("查看最基础的代码。现在我们可以总结整体流程。 从"),(0,e._)("code",null,"node server.js"),(0,e.Uk)("调用开始，我们在浏览器输入"),(0,e._)("code",null,"localhost:3000"),(0,e.Uk)("调用了"),(0,e._)("code",null,"server"),(0,e.Uk)("路由，在路由中调用了"),(0,e._)("code",null,"renderer.renderToString()"),(0,e.Uk)("， 将代码渲染到客户端，查看引入的")],-1),en=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverBundle "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-server-bundle.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientManifest "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-client-manifest.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br")])],-1),tn=(0,e._)("p",null,"两个json文件我们发现，之前的app.js和app.vue代码都已经打包进了，json文件中",-1),on=(0,e._)("h3",{id:"开发模式构建",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#开发模式构建","aria-hidden":"true"},"#"),(0,e.Uk)(" 开发模式构建")],-1),cn=(0,e._)("p",null,[(0,e.Uk)("在完成基础的宏能以后，我们给开发状态，添加文件修改的监听刷新功能和热更新功能，主要使用了"),(0,e._)("code",null,"webpack-dev-middleware"),(0,e.Uk)("和"),(0,e._)("code",null,"webpack-hot-middleware"),(0,e.Uk)(" 直接看代码，在"),(0,e._)("code",null,"server.js"),(0,e.Uk)("中，我们加入了一个"),(0,e._)("code",null,"setupDevServer"),(0,e.Uk)("方法，回调执行了"),(0,e._)("code",null,"createBundleRenderer"),(0,e.Uk)("去生成render，在这个回调中，去编写热更新 注意"),(0,e._)("code",null,"onReady"),(0,e.Uk)("返回的是一个promise，为什么看下面")],-1),ln=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" renderer\n"),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" onReady\n\n"),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("isPord"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverBundle "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-server-bundle.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientManifest "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./dist/vue-ssr-client-manifest.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" template "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" fs"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./index.template.html'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n  renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"createBundleRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("serverBundle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    template"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    clientManifest"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"else"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 开发模式 --\x3e 监视打包构建 --\x3e 重新生成 Renderer渲染器"),(0,e.Uk)("\n  onReady "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"setupDevServer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("server"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("serverBundle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" template"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" clientManifest")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    renderer "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"createBundleRenderer"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("serverBundle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      template"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n      clientManifest"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\nserver"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"get"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token string"},"'/'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  isPord\n    "),(0,e._)("span",{class:"token operator"},"?"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"render"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"async"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("req"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" res")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token comment"},"// 等待有了 renderer渲染器以后，调用render进行渲染"),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token keyword"},"await"),(0,e.Uk)(" onReady\n        "),(0,e._)("span",{class:"token function"},"render"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("req"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" res"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br")])],-1),pn=(0,e._)("p",null,[(0,e._)("code",null,"setupDevServer"),(0,e.Uk)("返回了一个"),(0,e._)("code",null,"Promise"),(0,e.Uk)("，在"),(0,e._)("code",null,"update"),(0,e.Uk)("的时候，等待"),(0,e._)("code",null,"template"),(0,e.Uk)("、"),(0,e._)("code",null,"serverbundle"),(0,e.Uk)("、 "),(0,e._)("code",null,"clientmanifest"),(0,e.Uk)("返回以后执行回调，其中做了监听相关的工作。这里注意关于"),(0,e._)("code",null,"devMiddleware"),(0,e.Uk)("的使用和4不同")],-1),un=(0,e._)("div",{class:"language-javascript ext-js line-numbers-mode"},[(0,e._)("pre",{class:"language-javascript"},[(0,e._)("code",null,[(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" fs "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'fs'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" path "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'path'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" chokidar "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'chokidar'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" webpack "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" devMiddleware "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-dev-middleware'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" hotMiddleware "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'webpack-hot-middleware'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n"),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"resolve"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"file"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" file"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\nmodule"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function-variable function"},"exports"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},[(0,e.Uk)("server"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" callback")]),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" ready\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" onReady "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},"Promise"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token parameter"},"r"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("ready "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" r"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n  "),(0,e._)("span",{class:"token comment"},"// 监事构建  -> 更新renderer"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" template\n  "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" serverBundle\n  "),(0,e._)("span",{class:"token keyword"},"let"),(0,e.Uk)(" clientManifest\n\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(),(0,e._)("span",{class:"token function-variable function"},"update"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token keyword"},"if"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("template "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" serverBundle "),(0,e._)("span",{class:"token operator"},"&&"),(0,e.Uk)(" clientManifest"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token function"},"ready"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token function"},"callback"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("serverBundle"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" template"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(" clientManifest"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 监视构建 template -> 调用 update -> 更新renderer渲染器"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" templatePath "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" path"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("__dirname"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'../index.template.html'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  template "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" fs"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("templatePath"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token function"},"update"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// chokidar"),(0,e.Uk)("\n  chokidar"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"watch"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("templatePath"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"on"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'change'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    template "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(" fs"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("templatePath"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"update"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n  "),(0,e._)("span",{class:"token comment"},"// 监视构建"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverConfig "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.server.config'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverCompiler "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"webpack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("serverConfig"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" serverDevMiddleware "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"devMiddleware"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("serverCompiler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    stats"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 关闭日志输出，由 FriendlyErrorsWebpackPlugin 处理"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  serverCompiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("done"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'server'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    serverBundle "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token constant"},"JSON"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"parse"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n      serverDevMiddleware"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("context"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("outputFileSystem"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../dist/vue-ssr-server-bundle.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"update"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 构建mainfest"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientConfig "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"require"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'./webpack.client.config'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  clientConfig"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("plugins"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"push"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token keyword"},"new"),(0,e.Uk)(),(0,e._)("span",{class:"token class-name"},[(0,e.Uk)("webpack"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("HotModuleReplacementPlugin")]),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  clientConfig"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("entry"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("app "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"["),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token string"},"'webpack-hot-middleware/client?quiet=true&reload=true'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 和服务端交互处理热更新一个客户端脚本"),(0,e.Uk)("\n    clientConfig"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("entry"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("app"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"]"),(0,e.Uk)("\n\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientCompiler "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"webpack"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("clientConfig"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token keyword"},"const"),(0,e.Uk)(" clientDevMiddleware "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token function"},"devMiddleware"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("clientCompiler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    publicPath"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(" clientConfig"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("output"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("publicPath"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    stats"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token comment"},"// 关闭日志输出，由 FriendlyErrorsWebpackPlugin 处理"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  clientCompiler"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("hooks"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("done"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"tap"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'client'"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)(),(0,e._)("span",{class:"token operator"},"=>"),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n    clientManifest "),(0,e._)("span",{class:"token operator"},"="),(0,e.Uk)(),(0,e._)("span",{class:"token constant"},"JSON"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"parse"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n      clientDevMiddleware"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("context"),(0,e._)("span",{class:"token punctuation"},"."),(0,e.Uk)("outputFileSystem"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"readFileSync"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token function"},"resolve"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token string"},"'../dist/vue-ssr-client-manifest.json'"),(0,e._)("span",{class:"token punctuation"},")"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n        "),(0,e._)("span",{class:"token string"},"'utf-8'"),(0,e.Uk)("\n      "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"update"),(0,e._)("span",{class:"token punctuation"},"("),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n  server"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"use"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token function"},"hotMiddleware"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("clientCompiler"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)(),(0,e._)("span",{class:"token punctuation"},"{"),(0,e.Uk)("\n      log"),(0,e._)("span",{class:"token operator"},":"),(0,e.Uk)(),(0,e._)("span",{class:"token boolean"},"false"),(0,e._)("span",{class:"token punctuation"},","),(0,e.Uk)("\n    "),(0,e._)("span",{class:"token punctuation"},"}"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n  "),(0,e._)("span",{class:"token comment"},"// 重要！！ 将devmiddleware挂载到express服务中，提供对其内部内存中数据的访问"),(0,e.Uk)("\n  server"),(0,e._)("span",{class:"token punctuation"},"."),(0,e._)("span",{class:"token function"},"use"),(0,e._)("span",{class:"token punctuation"},"("),(0,e.Uk)("clientDevMiddleware"),(0,e._)("span",{class:"token punctuation"},")"),(0,e.Uk)("\n\n  "),(0,e._)("span",{class:"token keyword"},"return"),(0,e.Uk)(" onReady\n"),(0,e._)("span",{class:"token punctuation"},"}"),(0,e.Uk)("\n\n")])]),(0,e._)("div",{class:"line-numbers"},[(0,e._)("span",{class:"line-number"},"1"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"2"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"3"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"4"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"5"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"6"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"7"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"8"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"9"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"10"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"11"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"12"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"13"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"14"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"15"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"16"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"17"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"18"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"19"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"20"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"21"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"22"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"23"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"24"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"25"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"26"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"27"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"28"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"29"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"30"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"31"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"32"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"33"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"34"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"35"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"36"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"37"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"38"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"39"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"40"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"41"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"42"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"43"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"44"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"45"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"46"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"47"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"48"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"49"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"50"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"51"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"52"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"53"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"54"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"55"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"56"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"57"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"58"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"59"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"60"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"61"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"62"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"63"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"64"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"65"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"66"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"67"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"68"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"69"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"70"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"71"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"72"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"73"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"74"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"75"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"76"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"77"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"78"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"79"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"80"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"81"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"82"),(0,e._)("br"),(0,e._)("span",{class:"line-number"},"83"),(0,e._)("br")])],-1),_n=(0,e._)("h2",{id:"路由处理",tabindex:"-1"},[(0,e._)("a",{class:"header-anchor",href:"#路由处理","aria-hidden":"true"},"#"),(0,e.Uk)(" 路由处理")],-1),rn={},kn=(0,a(3744).Z)(rn,[["render",function(n,s){return(0,e.wg)(),(0,e.iD)(e.HY,null,[o,c,l,p,u,_,r,k,i,b,U,m,d,g,v,f,w,h,y,x,j,q,S,C,P,R,M,V,B,F,D,E,N,T,$,J,W,z,O,A,L,H,I,Z,X,Y,G,K,Q,nn,sn,an,en,tn,on,cn,ln,pn,un,_n],64)}]])},3744:(n,s)=>{s.Z=(n,s)=>{for(const[a,e]of s)n[a]=e;return n}},8706:(n,s,a)=>{n.exports=a.p+"assets/img/1.94e8c534.png"}}]);